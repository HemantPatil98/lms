{%extends 'admin/base.html'%}
{%load admin_menu%}
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    {%block content_header%}
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0">Student Data</h1>
          </div><!-- /.col -->
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active">Student Data</li>
            </ol>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    {%endblock%}
    <!-- /.content-header -->

    <!-- Main content -->
    {%block content%}
    <section class="content">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-12">
            <!-- general form elements -->
            <div class="card card-primary">
              <div class="card-header">
                <h3 class="card-title">Student Data</h3>
              </div>
              <!-- /.card-header -->
              <!-- form start -->
              <div class="card-body" style="overflow: auto;">
                  <table id="example2" class="table table-bordered table-hover">
                    <thead>
                    <tr>
                      <th>Id</th>
                      <th>Date</th>
                      <th>Center</th>
                      <th>Date of Admission</th>
                      <th>Course</th>
                      <th>Batch start Date</th>
                      <th>Module Start From</th>
                      <th>Trainingmode</th>
                      <th>Name</th>
                      <th>Address</th>
                      <th>Date of Birth</th>
                      <th>Contact</th>
                      <th>Email id</th>
                      <th>Alternate Contact</th>
                      <th>Examination<br><a id="expand">Expand+</a></th>
                      <th class="educol hide">Stream</th>
                      <th class="educol hide">Name of School/Collage</th>
                      <th class="educol hide">Board/University</th>
                      <th class="educol hide">Year of Passing</th>
                      <th>Percentage</th>
                      <th>Fees</th>
                      <th>Mode of Fees</th>
                      <th>Regammount</th>
                      <th>Installment1</th>
                      <th>Installment2</th>
                      <th>Installment3</th>
                      <th>Regdate</th>
                      <th>Installment1date</th>
                      <th>Installment2date</th>
                      <th>Installment3date</th>
                      <th>Remark</th>
                    </tr>
                    </thead>
                    <tbody>
    {%firstof 1 as i%}
    {%for value in data%}
    <tr {%if i|add:-1|divisibleby:4%}class='edurow1'{%endif%}>
      {%for v in value%}
      {%if i|add:-1|divisibleby:4%}

      {%if forloop.counter < 21 %}


      <td {%if forloop.counter < 15 or forloop.counter > 22%}rowspan="4"{%endif%} {%if forloop.counter < 20 and forloop.counter > 15%}class="educol hide"{%endif%} {%if forloop.counter == 2%} class="date" {%endif%} {%if forloop.counter == 20%} class="course" {%endif%} idvalue="{{i|add:-1|div:4|add:1}}" rowv="{{i}}" colv="{{forloop.counter}}">{{v}}</td>

      {%else%}

      {%endif%}

      {%if forloop.counter >= 21%}

        
        <td rowspan="4" idvalue="{{i|add:-1|div:4|add:1}}" rowv="{{i}}" colv="{{forloop.counter}}">{{v}}</td>
        {%endif%}

      {%elif v%}
      <td {%if forloop.counter < 22 and forloop.counter > 15 or not i|add:-1|div:4%}class="edurow hide"{%endif%} idvalue="{{i|add:-1|div:4|add:1}}" rowv="{{i}}" colv="{{forloop.counter}}">{{v}}</td>
      {%endif%}
      {%endfor%}
    </tr>
    {%firstof i|add:1 as i%}
    {%endfor%}
                    </tbody>
                    <tfoot>

                    </tfoot>
                </table>
              </div>
            </div>
        </div>
      </div>
    </div>


      <iframe id="backend" src="" style="display: none;"></iframe>
    </section>
    {%endblock%}
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
{%block script%}
<style type="text/css">
  .hide{
    display: none;
  }
</style>

<script type="text/javascript">
  active_cell_value= "";
  $("td").click(function(){
    active_cell_value=$("input[name='value']").val();
    $("input[name='value']").parent().text(active_cell_value);
    if($(this).attr("colv") != 1 & $(this).attr("colv") != 2){
      value=$(this).text();
    $(this).html("<input type='text' class=form-control name='value' value='"+value+"' onchange='back()' onkeypress='myFunction(event)'>");
    }
    

  });

  function myFunction(event){
    // alert();
    var Code = event.keyCode || event.which;
    // alert(Code);
    if (Code == 13) {
    active_cell_value=$("input[name='value']").val();
    $("input[name='value']").parent().text(active_cell_value);  
    }
    
  }
  function back(){
    rowv=$("input[name='value']").parent().attr('rowv');
    colv=$("input[name='value']").parent().attr('colv');
    idvalue=$("input[name='value']").parent().attr('idvalue');
    active_cell_value=$("input[name='value']").val();

    $("#backend").attr("src","/admin/include/view_data/"+idvalue+"/"+rowv+"/"+colv+"/"+active_cell_value+"/True/");

  }
</script>
<script>
  $(document).ready(function(){
    $("#expand").click(function(){
      $(".educol").toggleClass("hide");
    });
    $("#expandrows").click(function(){
      $(".educol").toggleClass("hide");
    });
    $("input[name='month']").change(function(){
      $("input[submit]").trigger("click");
    });
    
  });

  $('.edurow1').dblclick(function(){
    $('.edurow').addClass('hide');
    $(this).next().children().removeClass('hide');
    $(this).next().next().children().removeClass('hide');
    $(this).next().next().next().children().removeClass('hide');
  });


  function filterdate() {
    board = [];
      $.each($(".date"), function(index, cell){
          board.push($(cell)); //Need to return contents of cell
      });
      // alert(board);
      for(i=0;i<51;i++){
        x=board[i].text();
        y=$("input[name='date']").val()
        // alert(board[i],$("input[name='date']").val());
        if (x!=y) {
          x = $(board[i]).parent()
          x.css("display","none");
          x=x.next("tr");
          x.css("display","none");
          x=x.next("tr");
          x.css("display","none");
          x=x.next("tr");
          x.css("display","none");
        }
        else{
          x = $(board[i]).parent()
          x.css("display","revert");
          x=x.next("tr");
          x.css("display","revert");
          x=x.next("tr");
          x.css("display","revert");
          x=x.next("tr");
          x.css("display","revert");
        }
      } 
  }

   function filtercourse() {
      board = [];
      $.each($(".course"), function(index, cell){
          board.push($(cell)); //Need to return contents of cell
      });
      // alert(board);
      // alert($(".course").text());
      c=$("#course").val();
      alert(c[0]);
      for(i=0;i<51;i++){
        // alert(board[i].text());
        x=board[i].text();
        // alert(x);
        if (x.search(c)==-1) {
          // alert("hi");
          x = $(board[i]).parent()
          x.css("display","none");
          x=x.next("tr");
          x.css("display","none");
          x=x.next("tr");
          x.css("display","none");
          x=x.next("tr");
          x.css("display","none");
        }
        else{
          x = $(board[i]).parent()
          x.css("display","revert");
          x=x.next("tr");
          x.css("display","revert");
          x=x.next("tr");
          x.css("display","revert");
          x=x.next("tr");
          x.css("display","revert");
        }
      }
   }
</script>
{%endblock%}



